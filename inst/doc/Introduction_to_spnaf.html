<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to spnaf</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to spnaf</h1>



<p>The <em>spnaf</em> package is developed for calculating spatial
network autocorrelation for flow data. Functions in the package are
designed specifically to evaluate how networks are spatially clustered,
in the form of <strong><span class="math inline">\(G_{ij}\)</span>
statistic</strong> which is presented in the <a href="https://link.springer.com/article/10.1007/s101090050013">paper</a>
written by Berglund and Karlström.</p>
<div id="data-ca" class="section level2">
<h2>Data: CA</h2>
<p>The package has a dataset called <strong>CA</strong> which stands for
California, US. This dataset contains migration amounts among CA
counties in 2019. The data consists of origins and destinations of each
residential flow.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(CA)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2580   12</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(CA)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   State.Code.of.Geography.A FIPS.County.Code.of.Geography.A</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                       006                             001</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                       006                             001</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                       006                             001</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                       006                             001</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5                       006                             001</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6                       006                             001</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   State.U.S..Island.Area.Foreign.Region.Code.of.Geography.B</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                                                       006</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                                                       006</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                                                       006</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                                                       006</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5                                                       006</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6                                                       006</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   FIPS.County.Code.of.Geography.B State.Name.of.Geography.A</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                             005                California</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                             007                California</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                             009                California</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                             011                California</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5                             013                California</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6                             015                California</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   County.Name.of.Geography.A</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1             Alameda County</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2             Alameda County</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3             Alameda County</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4             Alameda County</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5             Alameda County</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6             Alameda County</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   State.U.S..Island.Area.Foreign.Region.of.Geography.B</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                                           California</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                                           California</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                                           California</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                                           California</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5                                           California</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6                                           California</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   County.Name.of.Geography.B Flow.from.Geography.B.to.Geography.A</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1              Amador County                                    0</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2               Butte County                                  304</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3           Calaveras County                                   49</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4              Colusa County                                    0</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        Contra Costa County                                 8761</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6           Del Norte County                                    1</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Counterflow.from.Geography.A.to.Geography.B</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                                          97</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                                        1259</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                                         349</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                                          29</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5                                       18007</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6                                          95</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Net.Migration.from.Geography.B.to.Geography.A</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                                           -97</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                                          -955</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                                          -300</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                                           -29</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5                                         -9246</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6                                           -94</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Gross.Migration.between.Geography.A.and.Geography.B</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                                                  97</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                                                1563</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                                                 398</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                                                  29</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5                                               26768</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6                                                  96</span></span></code></pre></div>
</div>
<div id="data-ca_polygon" class="section level2">
<h2>Data: CA_polygon</h2>
<p>The package also has a sf object called <strong>CA_polygon</strong>
which is a <em>sf</em> class object that represents boundaries of CA
counties. It has id column and geometry column and can be plotted by
attaching the <em>sf</em> package. The polygon can be joined with
<strong>CA</strong> since it has id column that matches County code of
<strong>CA</strong>. You can learn more about how to deal with spatial
objects at <a href="https://r-spatial.github.io/sf/" class="uri">https://r-spatial.github.io/sf/</a>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CA_polygon, <span class="at">col =</span> <span class="st">&#39;white&#39;</span>, <span class="at">main =</span> <span class="st">&#39;CA polygon&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="function-gij.polygon" class="section level2">
<h2>Function: Gij.polygon</h2>
<p><em>spnaf</em> package aims to measure spatial density of networks,
which have origins (starting point) and destinations (ending point).
Main function of <em>spnaf</em> is called <strong>Gij.polygon</strong>
and the first main input of the function is <strong>df</strong> which is
OD data in a data.frame form that must contain “oid”, “did”, and “n”
(please refer to the help document) like CA above. The second important
input is <strong>shape</strong> which is corresponding polygon object in
<em>sf</em> class. The function also inherited two parameters from <a href="https://r-spatial.github.io/spdep/"><em>spdep</em></a> such as
<strong>queen, snap</strong>. The parameter <strong>method</strong> is
one of c(“t”, “o”, “d”) which stand for total, origins only, and
destinations only respectively (Please check <a href="https://link.springer.com/article/10.1007/s10109-008-0068-2">this
paper</a> to get more information about the method). The last parameter
<strong>n</strong> is used for bootstrapping permutation of resampling
the individual statistic n times to generate a non-parametric
distribution, since there would be a violation of the assumption of
normality when one tries to calculate a spatial statistic with
polygons(see how authors told about it in <a href="https://onlinelibrary.wiley.com/doi/10.1111/j.1538-4632.1992.tb00261.x">this
paper</a>). The process should be done to ensure a statistical
significance of the statistic.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">args</span>(Gij.polygon)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; function (df, shape, queen = TRUE, snap = 1, method = &quot;t&quot;, R = 1000) </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; NULL</span></span></code></pre></div>
<div id="how-to-execute" class="section level3">
<h3>How to execute</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data manipulation</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>CA <span class="ot">&lt;-</span> spnaf<span class="sc">::</span>CA</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>OD <span class="ot">&lt;-</span> <span class="fu">cbind</span>(CA<span class="sc">$</span>FIPS.County.Code.of.Geography.B, CA<span class="sc">$</span>FIPS.County.Code.of.Geography.A)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>OD <span class="ot">&lt;-</span> <span class="fu">cbind</span>(OD, CA<span class="sc">$</span>Flow.from.Geography.B.to.Geography.A)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>OD <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(OD)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(OD) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;oid&quot;</span>, <span class="st">&quot;did&quot;</span>, <span class="st">&quot;n&quot;</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>OD<span class="sc">$</span>n <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(OD<span class="sc">$</span>n)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>OD <span class="ot">&lt;-</span> OD[<span class="fu">order</span>(OD[,<span class="dv">1</span>], OD[,<span class="dv">2</span>]),]</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(OD) <span class="co"># check the input df&#39;s format</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     oid did     n</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 63  001 005    97</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 108 001 007  1259</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 160 001 009   349</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 201 001 011    29</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 229 001 013 18007</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 280 001 015    95</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Load sf polygon</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>CA_polygon <span class="ot">&lt;-</span> spnaf<span class="sc">::</span>CA_polygon</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(CA_polygon) <span class="co"># it has geometry column</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 6 features and 1 field</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: -124.4096 ymin: 35.90691 xmax: -118.3606 ymax: 41.46584</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Geodetic CRS:  NAD83</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    id                       geometry</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 001 MULTIPOLYGON (((-122.3423 3...</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 003 MULTIPOLYGON (((-120.0724 3...</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 005 MULTIPOLYGON (((-121.0274 3...</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 013 MULTIPOLYGON (((-122.4298 3...</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 019 MULTIPOLYGON (((-120.9094 3...</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 023 MULTIPOLYGON (((-124.4086 4...</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Execution of Gij.polygon with data above and given parameters</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">Gij.polygon</span>(<span class="at">df =</span> OD, <span class="at">shape =</span> CA_polygon, <span class="at">queen =</span> <span class="cn">TRUE</span>, <span class="at">snap =</span> <span class="dv">1</span>,</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="at">method =</span> <span class="st">&#39;t&#39;</span>, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (1) Creating Spatial Weights... Done !</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; note: Total 3306 network combinations are ready to be analyzed</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; note: which is calculated by the input polygon data</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (2) Calculating Gij ... Done! </span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (3) Do bootstrapping ... Done ! </span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (4) Generating result in lines ... Done !</span></span></code></pre></div>
</div>
<div id="interpretation-of-the-result" class="section level3">
<h3>Interpretation of the result</h3>
<p>The metric, an extended statistic of Getis and Ord (1992), <span class="math inline">\(G_{i}^{*}\)</span>, has similar intuition of
hotspot analysis with static data: a high and significant value in a
flow indicates spatial clustering of flows with high values. it can be
interpreted as Z-value suitable for conducting statistical tests as the
metric inherited the characteristics of <span class="math inline">\(G_{i}^{*}\)</span>. If one conducted bootstrapping
for 1,000 times like above, those with a value greater than the 50th
largest value of the distribution (i.e., at the significance level of
0.05) can be defined as positive clusters.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># positive clusters at the significance level of 0.05</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(result[[<span class="dv">1</span>]][result[[<span class="dv">1</span>]]<span class="sc">$</span>pval <span class="sc">&lt;</span> <span class="fl">0.05</span>,])</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    oid did     n      Gij  pval</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  001 013 18007 7.456884 0.008</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18 001 037  3957 2.754069 0.031</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20 001 041   959 2.281708 0.030</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 23 001 047   586 2.548161 0.034</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 29 001 059   953 1.960098 0.036</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 33 001 067  3616 6.859656 0.012</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># positive clusters at the significance level of 0.05 in lines class</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(result[[<span class="dv">2</span>]][result[[<span class="dv">2</span>]]<span class="sc">$</span>pval <span class="sc">&lt;</span> <span class="fl">0.05</span>,])</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 6 features and 5 fields</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Geometry type: LINESTRING</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: -122.7238 ymin: 33.7029 xmax: -117.7608 ymax: 38.44905</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Geodetic CRS:  NAD83</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    oid did     n      Gij  pval                            sfc</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  001 013 18007 7.456884 0.008 LINESTRING (-121.8887 37.64...</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18 001 037  3957 2.754069 0.031 LINESTRING (-121.8887 37.64...</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20 001 041   959 2.281708 0.030 LINESTRING (-121.8887 37.64...</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 23 001 047   586 2.548161 0.034 LINESTRING (-121.8887 37.64...</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 29 001 059   953 1.960098 0.036 LINESTRING (-121.8887 37.64...</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 33 001 067  3616 6.859656 0.012 LINESTRING (-121.8887 37.64...</span></span></code></pre></div>
</div>
<div id="visualization-of-all-flows-and-significant-flows0.05-only" class="section level3">
<h3>Visualization of all flows and Significant Flows(&lt;0.05) only</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot all flows with the polygon (left)</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(CA_polygon) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>()<span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(result[[<span class="dv">2</span>]]) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>()</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot significant flows only with the polygon (right)</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(CA_polygon) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>()<span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(result[[<span class="dv">2</span>]][result[[<span class="dv">2</span>]]<span class="sc">$</span>pval <span class="sc">&lt;</span> <span class="fl">0.05</span>,]) <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">col=</span><span class="st">&#39;pval&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="45%" /><img src="data:image/png;base64,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" width="45%" /></p>
</div>
<div id="reference" class="section level3">
<h3>Reference</h3>
<ul>
<li>Berglund, S. &amp; Karlström, A. (1999). Identifying local spatial
association in flow data, <em>Journal of Geographical Systems</em>,
1(3), 219-236. <a href="https://doi.org/10.1007/s101090050013" class="uri">https://doi.org/10.1007/s101090050013</a><br />
</li>
<li>Getis, A. &amp; Ord, J. K. (1992). The Analysis of Spatial
Association by Use of Distance Statistics, <em>Geographical
Analysis</em>, 24(3), 189-206. <a href="https://doi.org/10.1111/j.1538-4632.1992.tb00261.x" class="uri">https://doi.org/10.1111/j.1538-4632.1992.tb00261.x</a><br />
</li>
<li>Chun, Y. (2008). Modeling network autocorrelation within migration
flows by eigenvector spatial filtering. <em>Journal of Geographical
Systems</em>, 10, 317–344. <a href="https://doi.org/10.1007/s10109-008-0068-2" class="uri">https://doi.org/10.1007/s10109-008-0068-2</a><br />
</li>
<li>Lee, Y., Park, S., Kim, K., Ha, H., and Lee, J. (2021). Discovering
Millennials’ Migration Clusters in Seoul, South Korea: A Local Spatial
Network Autocorrelation Approach. <em>Findings</em>, November. <a href="https://doi.org/10.32866/001c.29523" class="uri">https://doi.org/10.32866/001c.29523</a>.</li>
</ul>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
